<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Code Trails — Is cosine simulairty a Hoax?</title>
    <meta name="description" content="Rendered blog post" />
    <style>
      :root { --bg:#ffffff; --fg:#030202; --muted:#6b7280; --divider:#e5e7eb; --maxw: 900px; }
      * { box-sizing: border-box; }
      body { margin:0; font-family: ui-sans-serif,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial; color:var(--fg); background:var(--bg); line-height:1.6; }
      .wrap { max-width: var(--maxw); margin: 0 auto; padding: 28px 20px 64px; }
      header h1 { font-size: clamp(28px, 4.5vw, 42px); margin: 6px 0 18px; letter-spacing: -0.01em; }
      .meta { color: var(--muted); font-size: 14px; margin-bottom: 18px; }
      article img { max-width: 100%; height: auto; border-radius: 4px; }
      article pre { background:#0f172a; color:#e2e8f0; padding:12px 14px; overflow:auto; border-radius:6px; }
      article code { background:#f3f4f6; padding: 0 4px; border-radius: 3px; }
      /* Ensure fenced code blocks are readable (no light background inside pre) */
      article pre code { background: transparent; padding: 0; color: inherit; }
      article h2 { font-size: 1.6rem; margin-top: 1.8rem; }
      article h3 { font-size: 1.3rem; margin-top: 1.4rem; }
      article h4 { font-size: 1.1rem; margin-top: 1.1rem; }
      article p { margin: 0.7rem 0; }
      article ul { padding-left: 1.2rem; }
      hr { border: 0; border-top: 1px solid var(--divider); margin: 18px 0; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <h1 id="post-title">HNSW and MMR - A Shallow Dive</h1>
        <div class="meta">By Elsa Hill — September 20, 2025</div>
      </header>
      <article id="post"></article>
    </div>

    <script id="md" type="text/markdown">





```
3rd - Investigating HNSW's and MMR - Math Hour 
		Show the graph theory behind it. 
		Algorithmic process behind it
		MMR

```

## Uncovering the truth
Previously in [my last blog post](https://git-mosis.github.io/code-trails/posts/Sept-1-25-understanding-cosine-simularity.html), we looked at why embedding models are imperative to semantic meaning. Today we be taking a closer look at using modern embeddings and their results. 

## It all started with a paper
Years ago, I found https://arxiv.org/pdf/1806.07366 that caught my attention. I wanted to see how David Duvenaud's research has progressed.

I decided to build a RAG pipeline. My workflow takes Duvenaud's academic papers, splits them into chunks, embeds them with Hugging Face models like `all-MiniLM-L6-v2`, and stores them in a vectorstore. For fast search, I’m using an HNSW index under the hood. The goal is simple: when I ask a question, I want my retriever to give me the most relevant, answers of text from the document to feed into an LLM. However first, I want to understand the retreval of text from the vector database. 


    </script>

    <script>
      function resolveUrl(url, baseDir) {
        if (/^(https?:)?\/\//i.test(url) || url.startsWith('/') ) return url;
        return baseDir + url.replace(/^\.\//, '');
      }

      function renderMarkdown(md, baseDir) {
        md = md.replace(/[&<>]/g, ch => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[ch]));
        md = md.replace(/\r\n?/g, '\n');

        // Code blocks ```...```
        md = md.replace(/```([\s\S]*?)```/g, (m, code) => '<pre><code>' + code.replace(/</g,'&lt;').replace(/>/g,'&gt;') + '</code></pre>');

        // Inline code
        md = md.replace(/`([^`]+)`/g, '<code>$1</code>');

        md = md.replace(/!\[([^\]\n]*)\]\(([^)]+)\)/g, (m, alt, src) => `<img alt="${alt}" src="${resolveUrl(src, baseDir)}">`);
        // Restrict links to avoid accidental multi-paragraph captures
        md = md.replace(/\[([^\]\n]+)\]\(([^)\s]+)\)/g, (m, text, href) => `<a href="${resolveUrl(href, baseDir)}" target="_blank" rel="noopener">${text}</a>`);
        md = md.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
        md = md.replace(/\*([^*]+)\*/g, '<em>$1</em>');
        const lines = md.split('\n');
        const out = [];
        let inList = false; let para = [];
        const flushPara = () => { if (para.length) { out.push('<p>' + para.join(' ').trim() + '</p>'); para = []; } };
        for (let i=0;i<lines.length;i++) {
          const line = lines[i];
          if (!line.trim()) { if (inList) { out.push('</ul>'); inList=false; } flushPara(); continue; }
          if (/^---\s*$/.test(line)) { if (inList) { out.push('</ul>'); inList=false; } flushPara(); out.push('<hr>'); continue; }
          if (/^####\s+/.test(line)) { if (inList) { out.push('</ul>'); inList=false; } flushPara(); out.push('<h4>' + line.replace(/^####\s+/, '') + '</h4>'); continue; }
          if (/^###\s+/.test(line))  { if (inList) { out.push('</ul>'); inList=false; } flushPara(); out.push('<h3>' + line.replace(/^###\s+/, '') + '</h3>'); continue; }
          if (/^##\s+/.test(line))   { if (inList) { out.push('</ul>'); inList=false; } flushPara(); out.push('<h2>' + line.replace(/^\#\#\s+/, '') + '</h2>'); continue; }
          const li = line.match(/^\s*-\s+(.*)$/);
          if (li) { flushPara(); if (!inList) { out.push('<ul>'); inList=true; } out.push('<li>' + li[1] + '</li>'); continue; }
          para.push(line.trim());
        }
        if (inList) out.push('</ul>');
        flushPara();
        return out.join('\n');
      }

      (function(){
        const md = document.getElementById('md').textContent;
        const baseDir = '../';
        document.getElementById('post').innerHTML = renderMarkdown(md, baseDir);
      })();
    </script>
  </body>
  </html>
